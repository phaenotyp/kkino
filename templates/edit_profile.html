{% extends "base.html" %} 

{% block content %} 
  <p>
  Bitte dieses Formular vollständig ausfüllen.
  </p>
<form action="example.py" id="dataForm">
  <fieldset class="alt">
                <fieldset>
                <legend><span>Angaben</span></legend>
                <ol>
                <li>
                <label for="mlurl">Url von MovieLens:</label>
                <input id="mlurl" name="mlurl" type="text" value="" />
                </li>
				<li>
					<label for="q">Mein Ort</label>
					<input id="q" name="q" type="text" value="" />
					<a href="#" onclick="showLocation(); return false;"> Ort suchen</a>
				</li>
				<li>
					<input type="hidden" name="lat" value="" id="lat" />
					<input type="hidden" name="long" value="" id="long" />
				</li>		
                <li>
                <div id="map"></div>
                </li>
                </ol>
        </fieldset>
                                        <fieldset class="submit">
                                        <input class="submit" type="submit" value="Speichern" />
                                </fieldset>
</form>
                </div>
                        

{% endblock content %} 


{% block javascript %} 
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key={{ api_key }}"  type="text/javascript"></script>

<script type="text/javascript" charset="UTF-8" src="http://maps.google.com/intl/en_ALL/mapfiles/127d/maps2.api/mod_control.js"></script>
<script src="http://www.google.com/uds/api?file=uds.js&v=1.0" type="text/javascript"></script>
<script src="http://www.google.com/uds/solutions/localsearch/gmlocalsearch.js" type="text/javascript"></script> 




    <script type="text/javascript">

    //<![CDATA[
	window.onload = function load(){
    var map;
    var geocoder;

	
	initialize();
}

    function initialize() {
        if (GBrowserIsCompatible()) {
        
          // Create and Center a Map
          map = new GMap2(document.getElementById("map"));
          map.setCenter(new GLatLng(37.4419, -122.1419), 13);
          map.addControl(new GLargeMapControl());
          map.addControl(new GMapTypeControl());
		  
		  geocoder = new GClientGeocoder();


          
	 }
    }

    // addAddressToMap() is called when the geocoder returns an
    // answer.  It adds a marker to the map with an open info window
    // showing the nicely formatted version of the address and the country code.
    function addAddressToMap(response) {
		
      map.clearOverlays();
      if (!response || response.Status.code != 200) {
        alert("Sorry, we were unable to geocode that address");
      } else {
        place = response.Placemark[0];
        point = new GLatLng(place.Point.coordinates[1],
                            place.Point.coordinates[0]);
		
        marker = new GMarker(point);
        map.addOverlay(marker);
		marker.openInfoWindowHtml(place.address + '<br>');
        document.getElementById('long').value = place.Point.coordinates[1] ;
        document.getElementById('lat').value = place.Point.coordinates[0];
      }
    }

    // showLocation() is called when you click on the Search button
    // in the form.  It geocodes the address entered into the form
    // and adds a marker to the map at that location.
    function showLocation() {
      var address = document.forms[0].q.value;
      geocoder.getLocations(address, addAddressToMap);
    }

   // findLocation() is used to enter the sample addresses into the form.
    function findLocation(address) {
      document.forms[0].q.value = address;
      showLocation();
    }

    //]]>
	
    </script>

{% endblock javascript %}

